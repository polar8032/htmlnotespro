<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>PocketHTML</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        :root {
            /* Dark Theme Colors */
            --bg-primary: #0a0a0a;
            --bg-secondary: #1a1a1a;
            --bg-tertiary: #2a2a2a;
            --surface: #161616;
            --surface-elevated: #202020;
            
            /* Text Colors */
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-tertiary: #707070;
            
            /* Accent Colors */
            --accent-blue: #0a84ff;
            --accent-purple: #bf5af2;
            --accent-pink: #ff375f;
            --accent-green: #30d158;
            --accent-orange: #ff9f0a;
            
            /* Gradient */
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-secondary: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --gradient-code: linear-gradient(180deg, #1a1a1a 0%, #0a0a0a 100%);
            
            /* Shadows */
            --shadow-sm: 0 2px 8px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 8px 32px rgba(0, 0, 0, 0.5);
            --glow-blue: 0 0 20px rgba(10, 132, 255, 0.3);
            --glow-purple: 0 0 20px rgba(191, 90, 242, 0.3);
            
            /* Fonts */
            --font-system: 'Inter', -apple-system, sans-serif;
            --font-code: 'SF Mono', 'Menlo', 'Monaco', 'Courier New', monospace;
            
            /* Dimensions */
            --header-h: 56px;
            --toolbar-h: 50px;
            --tab-h: 75px;
            --border-radius: 16px;
        }

        * { 
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: var(--font-system);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }

        /* === HEADER === */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: calc(var(--header-h) + env(safe-area-inset-top));
            padding-top: env(safe-area-inset-top);
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-left: 20px;
            padding-right: 20px;
            z-index: 100;
            box-shadow: var(--shadow-sm);
        }

        h1 { 
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 50%;
            letter-spacing: -0.3px;
        }
        
        button { 
            background: none;
            border: none;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.2s ease;
            font-family: var(--font-system);
        }
        
        .btn-link { 
            color: var(--accent-blue);
            font-weight: 600;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        
        .btn-link:active {
            transform: scale(0.95);
            opacity: 0.7;
        }

        /* === EDITOR AREA === */
        #editor-area {
            position: fixed;
            top: calc(var(--header-h) + env(safe-area-inset-top));
            bottom: calc(var(--tab-h) + var(--toolbar-h) + env(safe-area-inset-bottom));
            left: 0;
            right: 0;
            display: flex;
            background: var(--gradient-code);
            z-index: 10;
        }

        #line-numbers {
            width: 50px;
            background: rgba(255, 255, 255, 0.02);
            color: var(--text-tertiary);
            font-family: var(--font-code);
            font-size: 13px;
            line-height: 22px;
            text-align: right;
            padding-top: 12px;
            padding-right: 8px;
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            overflow: hidden;
            user-select: none;
            font-weight: 500;
        }

        #code-input {
            flex: 1;
            background: transparent;
            color: #e8e8e8;
            font-family: var(--font-code);
            font-size: 14px;
            line-height: 22px;
            border: none;
            padding: 12px 16px;
            resize: none;
            outline: none;
            white-space: pre;
            overflow: auto;
            -webkit-overflow-scrolling: touch;
        }

        #code-input::selection {
            background: rgba(10, 132, 255, 0.3);
        }

        /* === PREVIEW AREA === */
        #preview-area {
            position: fixed;
            top: calc(var(--header-h) + env(safe-area-inset-top));
            bottom: calc(var(--tab-h) + env(safe-area-inset-bottom));
            left: 0;
            right: 0;
            background: #ffffff;
            z-index: 20;
            display: none;
            flex-direction: column;
        }

        .url-bar {
            height: 38px;
            background: linear-gradient(180deg, #f8f8f8 0%, #f0f0f0 100%);
            color: #666;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            border-bottom: 1px solid #e0e0e0;
            flex-shrink: 0;
            gap: 6px;
            letter-spacing: 0.2px;
        }

        iframe {
            flex: 1;
            border: none;
            width: 100%;
            height: 100%;
            display: block;
            background: white;
        }

        /* === TOOLBAR === */
        #toolbar {
            position: fixed;
            bottom: calc(var(--tab-h) + env(safe-area-inset-bottom));
            left: 0;
            right: 0;
            height: var(--toolbar-h);
            background: var(--surface-elevated);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 12px;
            overflow-x: auto;
            overflow-y: hidden;
            z-index: 100;
            -webkit-overflow-scrolling: touch;
        }
        
        .key-btn {
            height: 36px;
            min-width: 36px;
            padding: 0 14px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border-radius: 10px;
            font-weight: 600;
            font-family: var(--font-code);
            font-size: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            white-space: nowrap;
            transition: all 0.2s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .key-btn:active {
            transform: scale(0.95);
            opacity: 0.8;
        }
        
        .action-key { 
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 700;
        }
        
        .copy { 
            background: linear-gradient(135deg, rgba(48, 209, 88, 0.15) 0%, rgba(48, 209, 88, 0.25) 100%);
            color: var(--accent-green);
            border: 1px solid rgba(48, 209, 88, 0.3);
        }
        
        .clear { 
            background: linear-gradient(135deg, rgba(255, 69, 58, 0.15) 0%, rgba(255, 69, 58, 0.25) 100%);
            color: var(--accent-pink);
            border: 1px solid rgba(255, 69, 58, 0.3);
        }

        .divider {
            width: 1px;
            height: 24px;
            background: linear-gradient(180deg, transparent 0%, rgba(255, 255, 255, 0.1) 50%, transparent 100%);
            margin: 0 4px;
            flex-shrink: 0;
        }

        /* === TAB BAR === */
        #tab-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(var(--tab-h) + env(safe-area-inset-bottom));
            background: var(--surface);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            display: flex;
            justify-content: space-around;
            align-items: flex-start;
            padding-top: 10px;
            padding-bottom: env(safe-area-inset-bottom);
            z-index: 100;
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .tab-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--text-tertiary);
            background: none;
            flex: 1;
            gap: 6px;
            transition: all 0.3s ease;
            position: relative;
            padding: 8px;
        }
        
        .tab-icon { 
            font-size: 26px;
            transition: all 0.3s ease;
            filter: grayscale(1);
        }
        
        .tab-label { 
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 0.3px;
            transition: all 0.3s ease;
        }
        
        .tab-item.active {
            color: var(--accent-blue);
        }
        
        .tab-item.active .tab-icon {
            filter: grayscale(0);
            transform: scale(1.1);
        }
        
        .tab-item.active::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 3px;
            background: var(--gradient-primary);
            border-radius: 0 0 3px 3px;
        }

        /* === FILES OVERLAY === */
        #files-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-primary);
            z-index: 2000;
            display: none;
            flex-direction: column;
        }
        
        .files-header {
            height: calc(var(--header-h) + env(safe-area-inset-top));
            padding-top: env(safe-area-inset-top);
            background: var(--surface-elevated);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            flex-shrink: 0;
            box-shadow: var(--shadow-sm);
        }
        
        .files-header-title {
            font-weight: 700;
            font-size: 20px;
            color: var(--text-primary);
            letter-spacing: -0.5px;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .new-file-btn {
            padding: 18px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            background: linear-gradient(135deg, rgba(10, 132, 255, 0.1) 0%, rgba(191, 90, 242, 0.1) 100%);
            color: var(--accent-blue);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            gap: 12px;
            align-items: center;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }
        
        .new-file-btn:active {
            background: linear-gradient(135deg, rgba(10, 132, 255, 0.15) 0%, rgba(191, 90, 242, 0.15) 100%);
            border-left-color: var(--accent-blue);
        }
        
        .new-file-icon {
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: rgba(10, 132, 255, 0.15);
            border-radius: 12px;
        }
        
        .file-list { 
            flex: 1;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .file-entry {
            padding: 18px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            background: var(--surface);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s ease;
        }
        
        .file-entry:active {
            background: var(--surface-elevated);
        }
        
        .file-info {
            flex: 1;
            cursor: pointer;
        }
        
        .file-name {
            font-weight: 600;
            font-size: 16px;
            color: var(--text-primary);
            margin-bottom: 6px;
            letter-spacing: -0.2px;
        }
        
        .file-date {
            font-size: 13px;
            color: var(--text-tertiary);
            font-weight: 500;
        }
        
        .delete-btn {
            font-size: 20px;
            color: var(--accent-pink);
            padding: 12px;
            border-radius: 10px;
            transition: all 0.2s ease;
        }
        
        .delete-btn:active {
            background: rgba(255, 69, 58, 0.1);
            transform: scale(0.9);
        }
        
        .backup-area {
            padding: 20px;
            background: var(--surface-elevated);
            border-top: 1px solid rgba(255, 255, 255, 0.08);
            padding-bottom: calc(20px + env(safe-area-inset-bottom));
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .full-btn { 
            width: 100%;
            padding: 16px;
            border-radius: 14px;
            font-weight: 700;
            border: none;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.3px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: var(--shadow-sm);
        }
        
        .full-btn:active {
            transform: scale(0.98);
        }
        
        .green { 
            background: linear-gradient(135deg, var(--accent-green) 0%, #28c74a 100%);
            color: #000;
        }
        
        .orange { 
            background: linear-gradient(135deg, var(--accent-orange) 0%, #ff8800 100%);
            color: #000;
        }
        
        .close-btn {
            color: var(--accent-blue);
            font-size: 16px;
            font-weight: 600;
        }

        .empty-state {
            padding: 60px 30px;
            text-align: center;
            color: var(--text-tertiary);
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: 16px;
            opacity: 0.3;
        }
        
        .empty-text {
            font-size: 15px;
            font-weight: 500;
        }

        /* === ANIMATIONS === */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .fade-in {
            animation: fadeIn 0.3s ease;
        }

        /* === SCROLLBAR STYLING === */
        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }
        
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        
        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

    </style>
</head>
<body>

    <header id="main-header">
        <button class="btn-link" onclick="openFiles()">
            <span>üìÅ</span>
            <span>Projetos</span>
        </button>
        <h1 id="doc-title">Sem T√≠tulo</h1>
        <button class="btn-link" id="btn-save" onclick="saveDoc()">Salvar</button>
    </header>

    <div id="editor-area">
        <div id="line-numbers">1</div>
        <textarea id="code-input" spellcheck="false" autocomplete="off" autocapitalize="off" placeholder="<!-- Escreva seu c√≥digo HTML aqui -->"></textarea>
    </div>

    <div id="preview-area">
        <div class="url-bar">
            <span>üîí</span>
            <span>Preview Local</span>
        </div>
        <iframe id="preview-frame"></iframe>
    </div>

    <div id="toolbar">
        <button class="key-btn action-key copy" onclick="copyCode()">üìã Copiar</button>
        <button class="key-btn action-key clear" onclick="clearCode()">üóëÔ∏è Limpar</button>
        <div class="divider"></div>
        <button class="key-btn" onclick="ins('<')">&lt;</button>
        <button class="key-btn" onclick="ins('>')">&gt;</button>
        <button class="key-btn" onclick="ins('/')">/</button>
        <button class="key-btn" onclick="ins('=')">=</button>
        <button class="key-btn" onclick="ins('\"')">\"</button>
        <button class="key-btn" onclick="ins('!')">!</button>
        <button class="key-btn" onclick="ins('class=\"\"')">class</button>
        <button class="key-btn" onclick="ins('<div></div>')">div</button>
    </div>

    <div id="tab-bar">
        <button class="tab-item active" id="tab-code" onclick="setMode('code')">
            <span class="tab-icon">üíª</span>
            <span class="tab-label">EDITOR</span>
        </button>
        <button class="tab-item" id="tab-view" onclick="setMode('view')">
            <span class="tab-icon">üëÅÔ∏è</span>
            <span class="tab-label">PREVIEW</span>
        </button>
    </div>

    <div id="files-overlay">
        <div class="files-header">
            <span class="files-header-title">Meus Projetos</span>
            <button class="close-btn" onclick="closeFiles()">Fechar</button>
        </div>
        <div class="new-file-btn" onclick="createFile()">
            <div class="new-file-icon">+</div>
            <span>Criar Novo Documento</span>
        </div>
        <div class="file-list" id="saved-list"></div>
        <div class="backup-area">
            <button class="full-btn green" onclick="exportData()">
                <span>‚¨á</span>
                <span>Baixar Backup</span>
            </button>
            <button class="full-btn orange" onclick="importTrigger()">
                <span>‚¨Ü</span>
                <span>Restaurar Backup</span>
            </button>
        </div>
    </div>
    <input type="file" id="json-input" accept=".json" style="display:none" onchange="importData(this)">

    <script>
        const editorArea = document.getElementById('editor-area');
        const previewArea = document.getElementById('preview-area');
        const toolbar = document.getElementById('toolbar');
        const overlay = document.getElementById('files-overlay');
        const codeInput = document.getElementById('code-input');
        const lineNums = document.getElementById('line-numbers');
        const iframe = document.getElementById('preview-frame');
        const titleEl = document.getElementById('doc-title');
        
        let currentId = null;

        function setMode(mode) {
            document.getElementById('tab-code').classList.remove('active');
            document.getElementById('tab-view').classList.remove('active');

            if (mode === 'code') {
                document.getElementById('tab-code').classList.add('active');
                editorArea.style.display = 'flex';
                toolbar.style.display = 'flex';
                previewArea.style.display = 'none';
            } else {
                document.getElementById('tab-view').classList.add('active');
                editorArea.style.display = 'none';
                toolbar.style.display = 'none'; 
                previewArea.style.display = 'flex';
                
                let content = codeInput.value.trim();
                
                if(!content.includes('<meta name="viewport"')) {
                    const vp = '<meta name="viewport" content="width=device-width, initial-scale=1.0">';
                    if(content.includes('<head>')) {
                        content = content.replace('<head>', '<head>' + vp);
                    } else if(content.includes('<html>')) {
                        content = content.replace('<html>', '<html><head>' + vp + '</head>');
                    } else {
                        content = vp + content;
                    }
                }

                if(!content) {
                    content = `
                        <div style="display: flex; align-items: center; justify-content: center; height: 100vh; font-family: -apple-system, sans-serif; color: #999; text-align: center; flex-direction: column; gap: 20px;">
                            <div style="font-size: 72px; opacity: 0.3;">üëÄ</div>
                            <div style="font-size: 18px; font-weight: 600;">Preview Vazio</div>
                            <div style="font-size: 14px; color: #666;">Escreva algum c√≥digo para visualizar</div>
                        </div>
                    `;
                }
                
                iframe.srcdoc = content;
            }
        }

        const updateLines = () => {
            const lines = codeInput.value.split('\n').length;
            lineNums.innerHTML = Array.from({length: lines}, (_, i) => i + 1).join('<br>');
        };
        
        codeInput.addEventListener('scroll', () => { 
            lineNums.scrollTop = codeInput.scrollTop;
        });
        
        codeInput.addEventListener('input', updateLines);

        function ins(txt) {
            const start = codeInput.selectionStart;
            const end = codeInput.selectionEnd;
            const val = codeInput.value;
            codeInput.value = val.substring(0, start) + txt + val.substring(end);
            codeInput.selectionStart = codeInput.selectionEnd = start + txt.length;
            
            if(txt.includes('></')) {
                codeInput.selectionStart = start + txt.indexOf('></') + 1;
            }
            if(txt.includes('""')) {
                codeInput.selectionStart = start + txt.indexOf('""') + 1;
            }
            
            codeInput.selectionEnd = codeInput.selectionStart;
            codeInput.focus();
            updateLines();
        }
        
        function copyCode() { 
            navigator.clipboard.writeText(codeInput.value).then(() => {
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = '‚úÖ Copiado!';
                btn.style.background = 'linear-gradient(135deg, rgba(48, 209, 88, 0.3) 0%, rgba(48, 209, 88, 0.4) 100%)';
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 2000);
            }).catch(() => {
                alert("Erro ao copiar");
            });
        }
        
        function clearCode() { 
            if(confirm("Apagar todo o c√≥digo atual?")) { 
                codeInput.value = "";
                updateLines();
            }
        }

        function openFiles() {
            loadList();
            overlay.style.display = 'flex';
            overlay.classList.add('fade-in');
            codeInput.blur();
        }

        function closeFiles() {
            overlay.style.display = 'none';
        }

        function createFile() {
            codeInput.value = "";
            titleEl.innerText = "Sem T√≠tulo";
            currentId = null;
            updateLines();
            closeFiles();
        }

        function saveDoc() {
            let name = prompt("Nome do arquivo:", titleEl.innerText === "Sem T√≠tulo" ? "index.html" : titleEl.innerText);
            if (!name) return;
            if (!currentId) currentId = Date.now().toString();
            
            const doc = { 
                id: currentId,
                name: name,
                content: codeInput.value,
                date: new Date().toLocaleDateString('pt-PT')
            };
            
            localStorage.setItem('phtml_' + currentId, JSON.stringify(doc));
            titleEl.innerText = name;
            
            const btn = event.target;
            const originalText = btn.innerHTML;
            btn.innerHTML = '‚úÖ Salvo!';
            setTimeout(() => {
                btn.innerHTML = originalText;
            }, 2000);
            
            loadList();
        }

        function loadList() {
            const list = document.getElementById('saved-list');
            list.innerHTML = '';
            let count = 0;
            
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('phtml_')) {
                    count++;
                    const doc = JSON.parse(localStorage.getItem(key));
                    const div = document.createElement('div');
                    div.className = 'file-entry';
                    div.innerHTML = `
                        <div class="file-info" onclick="loadFile('${doc.id}')">
                            <div class="file-name">üìÑ ${doc.name}</div>
                            <div class="file-date">Atualizado: ${doc.date}</div>
                        </div>
                        <button class="delete-btn" onclick="delFile('${doc.id}')">üóëÔ∏è</button>
                    `;
                    list.appendChild(div);
                }
            }
            
            if (count === 0) {
                list.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üì≠</div>
                        <div class="empty-text">Nenhum documento salvo ainda</div>
                    </div>
                `;
            }
        }

        function loadFile(id) {
            const doc = JSON.parse(localStorage.getItem('phtml_' + id));
            if (doc) {
                codeInput.value = doc.content;
                titleEl.innerText = doc.name;
                currentId = doc.id;
                updateLines();
                closeFiles();
            }
        }

        function delFile(id) {
            if (confirm("Apagar este documento permanentemente?")) {
                localStorage.removeItem('p
